package de.hsrm.cs.emu.interton;

import de.hsrm.cs.emu.interton.exception.RomAddrNotValidException;
import de.hsrm.cs.emu.interton.exception.RomNotInitializedException;

// encapsulates the rom content for us
public class ROM {
	
	// the actual content of the ROM
	// note: we always use short to prevent problems with the signed type byte
	private static short[] rom_content = null;
	
	// static constructor will be called when the class is first used/needed
	static {
		// hex representation of the ROM content (pong game)
		String rom_hex_string = "201B011776FF75FF77027440C1CD7EFFF97B3F057A3F04560C1F5018033F00A03F04511B700F1F4E0F663BC20D1F590E660CE19A070E660DE1990101CC1F0C0D1F5A0E660CE19A070E660DE1990101CC1F1C0D1F570E6610E7079A06E5601A0CA560E19A070E660EE1990101CC1F0A0D1F580E660FE7079A06E5C8190C8537E199070E6611E19A0101CC1F1A17060104044C1F6562C8FB1706021B7306031B6F200502CD7F62F97B0D1F0F1802F903CC1FC7C9F50C1F62180D84FFC8F8440398040428C8EB170D1F4CE5D219136C1FCAC2460118780D1FCBCD1F5468F1CC1F530F1F4E08F9441018053F02771B080E1F54460ABC01C50E1F4FE60198043B901B87E60398053B981F0163E60298133F008D0C1F61E4073D00980C1F61E40F3D009C0C1F6398E2E60498043BE31B06E60598313BE30C1F654404180406001B0206040E7E886E7E8A4480CC1F690E7E893ACE08F7EC1F6A180BC8FA0D1F660D61B9CC1F663F02A80D1F653F01B10C1F528D6253C8F90F1F4E0F67EF443C182508A088ACE41819020419C8A404074C1F5C9811088D8401EF61BC1A05E40E190117CC1F5E170D1F663B0908848D6232CC1F4C170C1F5C4401D161170203000106070405060607083F02634602180206100F67C5E414182D0E7F0CA8D40C6242C8880F67EF443C180C0D1F66D108848D6232CC1F5E0D1F650218054504982E1745041829170E7F0AAC1F4A8401440F0C6242CC1F6508D32407C8CF0C1F4E0F67EF443C1408CD24FF8401C8C7170C1F652404C8FA17FEFEFEFFFFFF0000000001010201020207070706060505050403020202010100000000FFFFFEFFFEFE00000101020102020C1F618401C8FA440F8401CC1FC70405CC1F0F173B6A0D1F4CE5191A04E5B39910CD1F63CD1F640F65FF44801C02123BFC0D1F4AE51B1A08E587190117E70914C9E01F022A0F65FFC14401B81F0C1F534410180F0F65FF4402B81F0F65FF4404BC03720F65FF4410BC03E1170C1F4AE4101E0409E49A1D04051708F10E1F63180FE7061805E7051829170E1F64981117E7071804E70898100E1F5E14E6F3191DE4511D04051F04090C1F6544041C04051B73E6B3990644FCE450186C170441CC1F4C1F0212162B3F53677B8FA30C141C242C343C444C545C646C747C8406070A0B0E0F121316171A1B1E1F22237FBFDFEFF7FBFDFE0F1F4A05100D632F84FEE318188401E3181384FEE3180EF96C170C1F6318060C1F64985C170C1F4C0608EE63271902FA7986FF0C1F4A0710EF632F1902FB7987FF035050504401D262C24707E7021A320E6340C20F6350CC1F68C30E7F8027FF43181C07014F1F4EBC022A08EB4E7F80EE7F80180ACE7F800BECE70B9C04220BE51702440198491B760C1F4AE4101A05E49A1901170C1F5D8401E4061825C8F60403C89004323B363F05651B1905011B020502CD1F510D7F5E846794CD7F5EE41598613F05210F1F4E1705020D7F5E846794CD7F5E9802F9730503C9D717CC1F6709D14D644DCC1FC73B133B0C0C1F501408ECF86917AA55FFB480187C17B4801A7C0504CD1E800D7FC9CD7F52F97806020C1F5C4401180C0E7F54CE7F56FA7876401B0A0E7F54CE7F58FA78744006020E7F5ECE7FC7FA780E1F5098330ABA98313B2598360C1F1E24FFC8FAC12C1F1F6408CC1FC6012C1F6CCC1FC12D1F6DCD1FC20532C9831B130C1F5CA401C8FA170A873B749805A601CE1F5B3F00250C1F52CC1F4A0C1E8B3A1C0C1E8B44409C054A1720098C8501E50D9805200501C891CD1F4E1B030C1F4F8401E4061864C8F60D1FAD856795C9F9CD1F60CD1FC920CC1FC3CC5E60A56225FFCD1F0E0403CC1F5B3F057D04053B0F08F0CC1FC704053B06C89BC8F60401B480187CB4801A7CF876170F1F4E0F67EFC8C6200608CE1F50CE7F5CFA7B0C1F5C4407CC1F663F008D20CC1F5ECC1F613B0C0863140432CC1F62173F04F30D1F4E0D6647CC1F1FCC1FC60D666BC20729E508191E0E4678CF7F83FB78E505981A200726CF7F7FFB7B0480CC1FA3CC1F9F1B080E471CCF7F83FB780D67C5C2070A0E47D2CF7EFFCF7F0FFB7507060F67BFCF7F47FB78E508990420CC1F4904FACC1F0DCC1F1DCC1F2C0450CC1F520465CC1FC00602D10D4654CE5FC1CE7F6C5A751701018181038282829C9C051C18C6538F215E18C64E8A2561B0B05090205F30C050941C6048B48F8F222221BEE28FE28F18C44868486818C4218F218F00060006120C18181E1E242A7D1C491B492F6D7A7D0B6C79250031042C073B002C011E020B0033020500020025072C00292952527B7BA4A429527BA47FFE0000000000000000000000000000000000000000000000000000000000007FFE000008000000087FFE4001400140014001400100000000000000004001400140014001400140017FFE000008000000084001400140014001400140014001400140014001400140014001408140014081FFFFFFFF00000000384001400140014001300C40014001400140014001400140014001400140014001FFFFFFFF00080000387FFE7C0040007C0040007C0040007C0040007C0040007C0040007C0040007C007FFE000008000000087FFE7FF040007FF040007FF040007FF040007FF040007FF040007FF040007FF07FFE000008000000087FFE380E0000380E0000380E0000380E0000380E0000380E0000380E0000380E7FFE000008000000087FFE1FFC00001FFC00001FFC00001FFC00001FFC00001FFC00001FFC00001FFC7FFE00000800000008010150F058F00A1E0A1E0A140A140A0A0A0A00101010101010100000000000007E7E7E0000000081818181818181000000000000040C040C8282008200000000";
		
		// convert hex to short array
		
		// get some space in array
		ROM.rom_content = new short[rom_hex_string.length()/2];
		
		// convert two characters to array element
		for(int i=0; i<rom_hex_string.length(); i=i+2) {
			ROM.rom_content[i/2] = Short.parseShort(rom_hex_string.substring(i, i+2), 16);
		}
	}
	
	// hide constructor to outside world
	private ROM() {
		
	}
	
	// return the byte of the ROM at the given addr
	public static short getByte(int addr) throws RomNotInitializedException, RomAddrNotValidException {
		// is rom content initialized?
		if(null != ROM.rom_content) {
			// is addr valid?
			if(0 <= addr && addr < (ROM.rom_content.length-1)) {
				return ROM.rom_content[addr];
			}
			else {
				// addr not valid
				throw new RomAddrNotValidException();
			}
		}
		else {
			// rom content not initialized
			throw new RomNotInitializedException();
		}
	}
	
//	// test if the encapsulation of the ROM works
//	public static void main(String[] args) {
//		for(int i=0; i<ROM.rom_content.length; i++) {
//			if(0==i%16) {
//				System.out.print("\r\n");
//				System.out.print(String.format("0x%03X ", i));
//			}
//			System.out.print(String.format("%02X ", ROM.rom_content[i]));
//		}
//	}
}
 